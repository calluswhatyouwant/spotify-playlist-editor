(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{115:function(e,t,a){},116:function(e,t,a){},117:function(e,t,a){},118:function(e,t,a){},119:function(e,t,a){},120:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(49),l=a.n(c),s=a(7),i=a(19),o=a(12),u=a(13),m=a(15),p=a(14),d=a(16),b=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={token:e.history.location.hash.match("[#&]access_token=([^&]*)")[1]},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){localStorage.setItem("token",this.state.token)}},{key:"render",value:function(){return this.state.token?r.a.createElement(i.a,{to:"/playlists"}):r.a.createElement(i.a,{to:"/"})}}]),t}(n.Component),y=(a(65),function(e){var t=e.href,a=e.text,n=e.type;return r.a.createElement("a",{className:"btn btn-lg btn-outline-light my-2 mx-1",href:t},r.a.createElement("i",{className:"fab fa-".concat(n)})," ",a)}),f=function(){return"https://accounts.spotify.com/authorize?".concat(h({client_id:"77edb9a2465445fc8b366da5105e7add",response_type:"token",redirect_uri:"https://calluswhatyouwant.github.io/spotify-playlist-editor/auth",scope:"playlist-read-private playlist-read-collaborative playlist-modify-public\n            playlist-modify-private user-read-recently-played user-top-read"}))},h=function(e){return Object.keys(e).map(function(t){return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t]))}).join("&")},E=function(){return r.a.createElement("div",{className:"home"},r.a.createElement("div",{className:"container text-center"},r.a.createElement("h1",{className:"display-1"},"Spotify Playlist Editor"),r.a.createElement("h4",null,"Sort your playlists any way you want."),r.a.createElement("p",null,"Note this is still a work in progress, so use it with caution!"),r.a.createElement(y,{href:f(),text:"Connect to Spotify",type:"spotify"}),r.a.createElement(y,{href:"https://github.com/calluswhatyouwant/spotify-playlist-editor",text:"Source code",type:"github"})))},g=function(){return r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},r.a.createElement("ul",{className:"navbar-nav mr-auto"},r.a.createElement("li",{className:"nav-item active"},r.a.createElement(s.b,{className:"nav-link",to:"/playlists"},"Playlists"))))},v=function(){return r.a.createElement("nav",{className:"navbar fixed-top navbar-expand-lg navbar-light bg-light"},r.a.createElement(s.b,{className:"navbar-brand",to:"/"},"Spotify Playlist Editor"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement(g,null))},k=a(3),N=a.n(k),w=a(11),O=a(1),x=function(e){var t=e.handleClick,a=e.type;return r.a.createElement("div",null,r.a.createElement("h3",null,"With your ",a," tracks"),r.a.createElement("div",{className:"center-wrapper"},r.a.createElement("button",{className:"btn btn-dark btn-purple px-4",onClick:function(){return t(a)}},r.a.createElement("h4",{className:"mb-0"},"CREATE PLAYLIST"))),r.a.createElement("hr",{className:"my-4"}))},j=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).getRecentlyPlayedTracks=function(){return Object(O.getCurrentUserRecentlyPlayedTracks)({limit:50}).then(function(e){return e.items.map(function(e){return e.track})})},a.getTopTracks=function(){return Object(O.getCurrentUserTopTracks)({limit:50,time_range:"long_term"}).then(function(e){return e.items})},a.createPlaylist=function(){var e=Object(w.a)(N.a.mark(function e(t){var n,r,c,l;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state.user,"top"!==t){e.next=7;break}return e.next=4,a.getTopTracks();case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,a.getRecentlyPlayedTracks();case 9:e.t0=e.sent;case 10:return r=e.t0,c=r.map(function(e){return e.uri}),e.next=14,Object(O.createPlaylist)(n.id,"Testing",{description:"Created with calluswhatyouwant's playlist editor."});case 14:l=e.sent,Object(O.addTracksToPlaylist)(l.id,c).then(function(){return a.setState({redirect:!0})});case 16:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.state={redirect:!1,user:{}},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(O.init)({token:localStorage.getItem("token")}),Object(O.getCurrentUserProfile)().then(function(t){e.setState({user:t})})}},{key:"render",value:function(){var e=this,t=this.state.redirect,a=["recent","top"].map(function(t){return r.a.createElement(x,{handleClick:e.createPlaylist,type:t})});return t?r.a.createElement(i.a,{to:"/playlists"}):r.a.createElement("div",{className:"playlist-page container mb-4 p-4 shadow"},r.a.createElement("h1",{className:"mb-4"},"Create a new playlist..."),a)}}]),t}(n.Component),C=(a(115),function(e){var t=e.playlistTrack.track;return r.a.createElement("li",{className:"media"},r.a.createElement("img",{className:"playlist-img mr-3",src:t.album.imageUrl,alt:t.albumName}),r.a.createElement("div",{className:"media-body"},r.a.createElement("h5",{className:"mt-0 mb-1"},r.a.createElement("b",null,t.name)),r.a.createElement("p",null,t.stringArtists)))}),T=function(e){var t=e.loading,a=e.tracks;return r.a.createElement("div",null,r.a.createElement("h3",{className:"mt-3"},"Tracks"),r.a.createElement("ul",{className:"list-unstyled"},t?r.a.createElement("h4",{className:"text-center"},"A little bit of patience now..."," ",r.a.createElement("i",{className:"fas fa-circle-notch spinner"})):a.map(function(e){return r.a.createElement(C,{key:e.id,playlistTrack:e})})))},P=a(18),S=a.n(P),A=[{description:"name",attribute:"track.name"},{description:"artist name",attribute:"track.stringArtists"},{description:"album name",attribute:"track.albumName"},{description:"length",attribute:"track.durationMs"},{description:"release date",attribute:"track.album.releaseDate"},{description:"popularity",attribute:"track.popularity"},{description:"addition date",attribute:"addedAt"}],I=function(){var e=Object(w.a)(N.a.mark(function e(t,a,n){var r;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object(O.init)({token:localStorage.getItem("token")}),e.next=3,L(t,a,n);case 3:return r=e.sent,e.abrupt("return",r.reduce(function(){var e=Object(w.a)(N.a.mark(function e(a,n){return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a;case 2:return e.abrupt("return",M(t,n));case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),Promise.resolve()));case 5:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),L=function(){var e=Object(w.a)(N.a.mark(function e(t,a,n){var r,c,l,s;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.getPlaylistTracks)(t,{limit:a});case 2:return r=e.sent,c=r.items.map(function(e,t){return{index:t,attribute:S.a.get(e,n)}}),l=S.a.sortBy(c,"attribute").reverse(),s=l.map(function(e){return e.index}),e.abrupt("return",R(s));case 7:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),R=function(e){for(var t=0;t<e.length;t++)for(var a=t+1;a<e.length;a++)e[t]>e[a]&&(e[a]+=1);return e},M=function(e,t){return Object(O.reorderPlaylistTracks)(e,t,{rangeLength:1,insertBefore:0})},U=function(e){var t=e.handleClick,a=A.map(function(e){var a=e.attribute,n=e.description;return r.a.createElement("button",{className:"text-uppercase dropdown-item",onClick:function(){return t(a)}},n)});return r.a.createElement("div",{className:"dropdown"},r.a.createElement("button",{className:"btn btn-dark dropdown-toggle",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"SORT PLAYLIST BY"),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton"},a))},B=(a(116),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleClick=function(e){var t=a.state,n=t.playlist,r=t.playlistId;a.setState({loading:!0}),I(r,n.totalTracks,e).then(function(){return Object(O.getPlaylist)(r).then(function(e){return a.setState({playlist:e,loading:!1})})})},a.state={playlist:{},playlistId:e.match.params.id,loading:!1},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(O.init)({token:localStorage.getItem("token")}),Object(O.getPlaylist)(this.state.playlistId).then(function(t){return e.setState({playlist:t})})}},{key:"render",value:function(){var e=this.state,t=e.playlist,a=e.loading;return t.name?r.a.createElement("div",{className:"playlist-page container mb-4 p-4 shadow"},r.a.createElement("h1",{className:"mb-4"},t.name),r.a.createElement(U,{handleClick:this.handleClick}),r.a.createElement(T,{loading:a,tracks:t.tracks.items})):null}}]),t}(n.Component)),D=function(e){var t=e.user;return r.a.createElement("div",{className:"user-page-header media p-3"},r.a.createElement("img",{src:t.images?t.images[0].url:"",alt:"Avatar",className:"user-image rounded-circle align-self-center"}),r.a.createElement("div",{className:"media-body align-self-center"},r.a.createElement("h1",{className:"text-center py-4 display-4"},"Welcome, ",t.displayName,"!")))},_=function(){return r.a.createElement("section",{className:"mb-3"},r.a.createElement("h2",null,"Create a new playlist"),r.a.createElement("p",null,"Highly recommended for testing, so that you don't overwrite your own playlists."),r.a.createElement("div",{className:"center-wrapper"},r.a.createElement(s.b,{className:"btn btn-dark btn-purple mx-1",to:"/playlists/new"},r.a.createElement("h4",{className:"px-3 mb-0"},"CREATE A NEW PLAYLIST"))))},Y=(a(117),function(e){var t=e.playlist;return r.a.createElement("div",{className:"user-playlist"},r.a.createElement("h4",null,t.name,r.a.createElement(s.b,{className:"badge badge-pill badge-dark mx-1",to:"/playlists/".concat(t.id)},"SORT / MANAGE")),r.a.createElement("h5",null,r.a.createElement("span",{className:"badge badge-info mr-1"},t.totalTracks," tracks"),r.a.createElement("span",{className:"badge badge-secondary"},t.collaborative?"COLLABORATIVE":t.public?"PUBLIC":"PRIVATE")),r.a.createElement("hr",{className:"my-4"}))}),W=function(e){var t=e.playlists,a=e.handleClick,n=e.hasNextPage,c=t.map(function(e){return r.a.createElement(Y,{playlist:e})}),l=r.a.createElement("div",{className:"center-wrapper"},r.a.createElement("button",{className:"btn btn-dark btn-purple",onClick:a},r.a.createElement("h4",{className:"px-3 mb-0"},"LOAD MORE PLAYLISTS")));return r.a.createElement("div",null,r.a.createElement("h2",{className:"mb-4"},"These are your playlists"),c,n&&l)},J=(a(118),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).componentDidMount=Object(w.a)(N.a.mark(function e(){var t,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object(O.init)({token:localStorage.getItem("token")}),e.next=3,Object(O.getCurrentUserPlaylists)({limit:5});case 3:return t=e.sent,e.next=6,Object(O.getCurrentUserProfile)();case 6:n=e.sent,a.setState({page:t,user:n,playlists:t.items});case 8:case"end":return e.stop()}},e)})),a.loadMorePlaylists=Object(w.a)(N.a.mark(function e(){var t,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.page,e.next=3,t.getNextPage();case 3:n=e.sent,a.setState(function(e){return{playlists:e.playlists.concat(n.items),page:n}});case 5:case"end":return e.stop()}},e)})),a.state={page:{},playlists:[],user:{}},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.playlists,a=e.page,n=e.user,c=t.filter(function(e){return e.owner.id===n.id});return a.items?r.a.createElement("div",{className:"user-page container mb-4 p-4 shadow"},r.a.createElement(D,{user:n}),r.a.createElement(_,null),r.a.createElement(W,{playlists:c,handleClick:this.loadMorePlaylists,hasNextPage:a.hasNext()})):null}}]),t}(n.Component)),V=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(v,null),r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/",component:E}),r.a.createElement(i.b,{exact:!0,path:"/auth",component:b}),r.a.createElement(i.b,{exact:!0,path:"/playlists",component:J}),r.a.createElement(i.b,{exact:!0,path:"/playlists/new",component:j}),r.a.createElement(i.b,{exact:!0,path:"/playlists/:id",component:B})))},z=(a(119),document.getElementById("root"));z&&l.a.render(r.a.createElement(s.a,{basename:"/spotify-playlist-editor"},r.a.createElement(V,null)),z)},52:function(e,t,a){e.exports=a(120)},65:function(e,t,a){}},[[52,1,2]]]);
//# sourceMappingURL=main.8c8e636b.chunk.js.map